<div class="dashboard-container">
    <div class="dashboard-welcome mb-4">
        <h1 class="dashboard-title h3">
            <i class="fas fa-user-graduate text-primary me-2"></i>
            Student Dashboard
        </h1>
        <p class="dashboard-subtitle text-muted mb-0">Welcome back, {{ currentUser?.firstName ||
            currentUser?.username }}!</p>
    </div>

    @if (isLoading) {
    <div class="loading-container text-center py-5">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-3 text-muted">Loading dashboard data...</p>
    </div>
    }

    @if (!isLoading) {
    <div class="dashboard-content">
        <div class="row g-3 mb-4">
            <div class="col-md-3 col-sm-6">
                <div
                    class="card border-0 shadow-sm h-100 bg-primary bg-opacity-10 border-start border-primary border-4">
                    <div class="card-body d-flex align-items-center">
                        <div class="rounded-circle bg-primary bg-opacity-10 p-3 me-3">
                            <i class="fas fa-book fa-fw text-primary"></i>
                        </div>
                        <div>
                            <h3 class="fw-bold h2 mb-0">{{ stats?.enrolledCourses || 0 }}</h3>
                            <p class="text-muted small mb-0">Enrolled Courses</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-3 col-sm-6">
                <div
                    class="card border-0 shadow-sm h-100 bg-success bg-opacity-10 border-start border-success border-4">
                    <div class="card-body d-flex align-items-center">
                        <div class="rounded-circle bg-success bg-opacity-10 p-3 me-3">
                            <i class="fas fa-trophy fa-fw text-success"></i>
                        </div>
                        <div>
                            <h3 class="fw-bold h2 mb-0">{{ stats?.completedCourses || 0 }}</h3>
                            <p class="text-muted small mb-0">Completed Courses</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-3 col-sm-6">
                <div
                    class="card border-0 shadow-sm h-100 bg-warning bg-opacity-10 border-start border-warning border-4">
                    <div class="card-body d-flex align-items-center">
                        <div class="rounded-circle bg-warning bg-opacity-10 p-3 me-3">
                            <i class="fas fa-tasks fa-fw text-warning"></i>
                        </div>
                        <div>
                            <h3 class="fw-bold h2 mb-0">{{ stats?.upcomingAssignments || 0 }}</h3>
                            <p class="text-muted small mb-0">Pending Tasks</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-3 col-sm-6">
                <div class="card border-0 shadow-sm h-100 bg-info bg-opacity-10 border-start border-info border-4">
                    <div class="card-body d-flex align-items-center">
                        <div class="rounded-circle bg-info bg-opacity-10 p-3 me-3">
                            <i class="fas fa-chart-line fa-fw text-info"></i>
                        </div>
                        <div>
                            <h3 class="fw-bold h2 mb-0">{{ stats?.averageGrade || 0 }}%</h3>
                            <p class="text-muted small mb-0">Average Grade</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-8 mb-4">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-white py-3 d-flex justify-content-between align-items-center">
                        <h5 class="card-title mb-0">
                            <i class="fas fa-book text-primary me-2"></i>
                            My Courses
                        </h5>
                        <button class="btn btn-sm btn-primary">
                            <i class="fas fa-search me-1"></i>
                            Browse Courses
                        </button>
                    </div>
                    <div class="card-body p-0 bg-light">
                        <div class="row g-0">
                            @for (course of courses; track course.id) {
                            <div class="col-md-6 p-3 border-end border-bottom">
                                <div class="d-flex justify-content-between mb-2">
                                    <h5 class="mb-0">{{ course.title }}</h5>
                                    <span class="badge rounded-pill text-bg-{{ getStatusColor(course.status) }}">
                                        {{ course.status }}
                                    </span>
                                </div>
                                <p class="text-muted small mb-3">{{ course.description }}</p>

                                <div class="d-flex align-items-center mb-3 text-muted small">
                                    <div class="me-3">
                                        <i class="fas fa-user me-1"></i>
                                        {{ course.instructor }}
                                    </div>
                                    <div class="me-3">
                                        <i class="fas fa-users me-1"></i>
                                        {{ course.enrolled }}
                                    </div>
                                    <div class="me-3">
                                        <i class="fas fa-clock me-1"></i>
                                        {{ course.duration }}
                                    </div>
                                    <div>
                                        <i class="fas fa-star text-warning me-1"></i>
                                        {{ course.rating }}
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <div class="progress" style="height: 8px;">
                                        <div class="progress-bar bg-primary" style="width: 65%"></div>
                                    </div>
                                    <div class="d-flex justify-content-end mt-1">
                                        <span class="text-muted small">65% Complete</span>
                                    </div>
                                </div>

                                <div class="d-flex gap-2">
                                    <button class="btn btn-sm btn-primary flex-grow-1">
                                        <i class="fas fa-play me-1"></i>
                                        Continue
                                    </button>
                                    <button class="btn btn-sm btn-outline-secondary">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            }

                            <!-- Empty state -->
                            @if (courses.length === 0) {
                            <div class="col-12 p-4 text-center">
                                <i class="fas fa-book-open fa-3x text-muted mb-3"></i>
                                <p>You haven't enrolled in any courses yet.</p>
                                <button class="btn btn-primary">Browse Courses</button>
                            </div>
                            }
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 mb-4">
                <div class="card border-0 shadow-sm h-100">
                    <div class="card-header bg-white py-3">
                        <h5 class="card-title mb-0">
                            <i class="fas fa-tasks text-warning me-2"></i>
                            Assignments & Tasks
                        </h5>
                    </div>
                    <div class="card-body p-0">
                        <div class="list-group list-group-flush">
                            @for (assignment of assignments; track assignment.id) {
                            <div class="list-group-item py-3 px-3">
                                <div class="d-flex justify-content-between mb-1">
                                    <h6 class="mb-0">{{ assignment.title }}</h6>
                                    <span class="badge rounded-pill text-bg-{{ getStatusColor(assignment.status) }}">
                                        {{ assignment.status }}
                                    </span>
                                </div>
                                <div class="text-muted small mb-2">{{ assignment.course }}</div>

                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="small" [class.text-danger]="getDaysUntilDue(assignment.dueDate) < 0">
                                        <i class="fas fa-calendar me-1"></i>
                                        Due: {{ formatDate(assignment.dueDate) }}
                                        @if (getDaysUntilDue(assignment.dueDate) >= 0) {
                                        <span class="text-muted">
                                            ({{ getDaysUntilDue(assignment.dueDate) }} days left)
                                        </span>
                                        }
                                        @if (getDaysUntilDue(assignment.dueDate) < 0) { <span
                                            class="text-danger fw-bold">
                                            (Overdue)
                                            </span>
                                            }
                                    </div>

                                    @if (assignment.grade) {
                                    <div class="badge text-bg-{{ getGradeColor(assignment.grade) }}">
                                        {{ assignment.grade }}%
                                    </div>
                                    }
                                </div>

                                <div class="d-flex gap-2 mt-2">
                                    @if (assignment.status === 'pending') {
                                    <button class="btn btn-sm btn-primary">
                                        <i class="fas fa-edit me-1"></i>
                                        Submit
                                    </button>
                                    }
                                    <button class="btn btn-sm btn-outline-secondary">
                                        <i class="fas fa-eye me-1"></i>
                                        View
                                    </button>
                                </div>
                            </div>
                            }

                            <!-- Empty state -->
                            @if (assignments.length === 0) {
                            <div class="p-4 text-center">
                                <i class="fas fa-clipboard-check fa-3x text-muted mb-3"></i>
                                <p>No assignments yet. Enjoy your free time!</p>
                            </div>
                            }
                        </div>
                    </div>
                </div>
            </div>

            <!-- Study Schedule -->
            <div class="col-lg-6 mb-4">
                <div class="card border-0 shadow-sm h-100">
                    <div class="card-header bg-white py-3">
                        <h5 class="card-title mb-0">
                            <i class="fas fa-calendar text-info me-2"></i>
                            Study Schedule
                        </h5>
                    </div>
                    <div class="card-body p-0">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item d-flex py-3">
                                <div class="text-center me-3">
                                    <div class="bg-primary bg-opacity-10 text-primary rounded px-3 py-2">
                                        <div class="fw-bold">9:00</div>
                                        <div class="small">AM</div>
                                        <div class="small mt-1">Today</div>
                                    </div>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-1">Angular Components Workshop</h6>
                                    <p class="text-muted small mb-2">Interactive session on component lifecycle</p>
                                    <span class="badge text-bg-primary">Live Session</span>
                                </div>
                            </li>

                            <li class="list-group-item d-flex py-3">
                                <div class="text-center me-3">
                                    <div class="bg-warning bg-opacity-10 text-warning rounded px-3 py-2">
                                        <div class="fw-bold">2:00</div>
                                        <div class="small">PM</div>
                                        <div class="small mt-1">Tomorrow</div>
                                    </div>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-1">React Hooks Assignment Due</h6>
                                    <p class="text-muted small mb-2">Submit your React hooks implementation</p>
                                    <span class="badge text-bg-warning">Due Soon</span>
                                </div>
                            </li>

                            <li class="list-group-item d-flex py-3">
                                <div class="text-center me-3">
                                    <div class="bg-info bg-opacity-10 text-info rounded px-3 py-2">
                                        <div class="fw-bold">11:00</div>
                                        <div class="small">AM</div>
                                        <div class="small mt-1">Wed</div>
                                    </div>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-1">TypeScript Quiz</h6>
                                    <p class="text-muted small mb-2">Advanced TypeScript concepts quiz</p>
                                    <span class="badge text-bg-info">Assessment</span>
                                </div>
                            </li>

                            <li class="list-group-item d-flex py-3">
                                <div class="text-center me-3">
                                    <div class="bg-success bg-opacity-10 text-success rounded px-3 py-2">
                                        <div class="fw-bold">3:30</div>
                                        <div class="small">PM</div>
                                        <div class="small mt-1">Fri</div>
                                    </div>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-1">Study Group: JavaScript Fundamentals</h6>
                                    <p class="text-muted small mb-2">Peer learning session with classmates</p>
                                    <span class="badge text-bg-success">Study Group</span>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="col-lg-6 mb-4">
                <div class="card border-0 shadow-sm h-100 bg-light">
                    <div class="card-header bg-light py-3">
                        <h5 class="card-title mb-0">
                            <i class="fas fa-bolt text-warning me-2"></i>
                            Quick Actions
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <button
                                    class="btn btn-light w-100 text-start p-3 h-100 d-flex align-items-center border">
                                    <div
                                        class="d-inline-flex align-items-center justify-content-center rounded-circle bg-primary bg-opacity-10 p-3 me-3">
                                        <i class="fas fa-search text-primary"></i>
                                    </div>
                                    <div>
                                        <h6 class="mb-0">Browse Courses</h6>
                                        <span class="text-muted small">Find new learning paths</span>
                                    </div>
                                </button>
                            </div>

                            <div class="col-md-6">
                                <button
                                    class="btn btn-light w-100 text-start p-3 h-100 d-flex align-items-center border">
                                    <div
                                        class="d-inline-flex align-items-center justify-content-center rounded-circle bg-success bg-opacity-10 p-3 me-3">
                                        <i class="fas fa-upload text-success"></i>
                                    </div>
                                    <div>
                                        <h6 class="mb-0">Submit Assignment</h6>
                                        <span class="text-muted small">Upload your work</span>
                                    </div>
                                </button>
                            </div>

                            <div class="col-md-6">
                                <button
                                    class="btn btn-light w-100 text-start p-3 h-100 d-flex align-items-center border">
                                    <div
                                        class="d-inline-flex align-items-center justify-content-center rounded-circle bg-info bg-opacity-10 p-3 me-3">
                                        <i class="fas fa-chart-bar text-info"></i>
                                    </div>
                                    <div>
                                        <h6 class="mb-0">View Progress</h6>
                                        <span class="text-muted small">Track your stats</span>
                                    </div>
                                </button>
                            </div>

                            <div class="col-md-6">
                                <button
                                    class="btn btn-light w-100 text-start p-3 h-100 d-flex align-items-center border">
                                    <div
                                        class="d-inline-flex align-items-center justify-content-center rounded-circle bg-warning bg-opacity-10 p-3 me-3">
                                        <i class="fas fa-users text-warning"></i>
                                    </div>
                                    <div>
                                        <h6 class="mb-0">Study Groups</h6>
                                        <span class="text-muted small">Learn with peers</span>
                                    </div>
                                </button>
                            </div>

                            <div class="col-md-6">
                                <button
                                    class="btn btn-light w-100 text-start p-3 h-100 d-flex align-items-center border">
                                    <div
                                        class="d-inline-flex align-items-center justify-content-center rounded-circle bg-secondary bg-opacity-10 p-3 me-3">
                                        <i class="fas fa-comments text-secondary"></i>
                                    </div>
                                    <div>
                                        <h6 class="mb-0">Ask Questions</h6>
                                        <span class="text-muted small">Get help & support</span>
                                    </div>
                                </button>
                            </div>

                            <div class="col-md-6">
                                <button
                                    class="btn btn-light w-100 text-start p-3 h-100 d-flex align-items-center border">
                                    <div
                                        class="d-inline-flex align-items-center justify-content-center rounded-circle bg-primary bg-opacity-10 p-3 me-3">
                                        <i class="fas fa-certificate text-primary"></i>
                                    </div>
                                    <div>
                                        <h6 class="mb-0">Certificates</h6>
                                        <span class="text-muted small">View achievements</span>
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Learning Progress -->
            <div class="col-lg-12 mb-4">
                <div class="card border-0 shadow-sm bg-light">
                    <div class="card-header bg-white py-3">
                        <h5 class="card-title mb-0">
                            <i class="fas fa-chart-line text-primary me-2"></i>
                            Learning Progress
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-lg-8">
                                <div class="mb-4">
                                    <div class="d-flex justify-content-between mb-2">
                                        <span>Angular Development</span>
                                        <span class="fw-bold">75%</span>
                                    </div>
                                    <div class="progress" style="height: 10px;">
                                        <div class="progress-bar bg-primary" style="width: 75%"></div>
                                    </div>
                                </div>

                                <div class="mb-4">
                                    <div class="d-flex justify-content-between mb-2">
                                        <span>React Fundamentals</span>
                                        <span class="fw-bold">45%</span>
                                    </div>
                                    <div class="progress" style="height: 10px;">
                                        <div class="progress-bar bg-info" style="width: 45%"></div>
                                    </div>
                                </div>

                                <div class="mb-4">
                                    <div class="d-flex justify-content-between mb-2">
                                        <span>TypeScript Mastery</span>
                                        <span class="fw-bold">30%</span>
                                    </div>
                                    <div class="progress" style="height: 10px;">
                                        <div class="progress-bar bg-success" style="width: 30%"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-4">
                                <h6 class="mb-3">Recent Achievements</h6>
                                <div class="d-flex flex-wrap gap-2">
                                    <div class="badge bg-warning bg-opacity-10 text-warning p-2 px-3">
                                        <i class="fas fa-trophy me-1"></i>
                                        First Course Completed
                                    </div>
                                    <div class="badge bg-success bg-opacity-10 text-success p-2 px-3">
                                        <i class="fas fa-star me-1"></i>
                                        Perfect Assignment Score
                                    </div>
                                    <div class="badge bg-info bg-opacity-10 text-info p-2 px-3">
                                        <i class="fas fa-users me-1"></i>
                                        Study Group Leader
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    }
</div>